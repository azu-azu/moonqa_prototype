# 🗺 MoonQAプロジェクトの全体フェーズ設計

| フェーズ                     | 概要                            | ステータス          |
| ------------------------ | ----------------------------- | -------------- |
| **Phase 1: ベース構築**       | ディレクトリ設計、`.env`管理、基本QA機能の実装   | ✅ 完了済み         |
| **Phase 2: テスト整備**       | `pytest` 化、自動質問テストの確立、精度確認    | ✅ 完了済み     |
| **Phase 3: 精度向上＆制御強化**   | `target_pdf`、スコア閾値、フィルタリングの導入 | ✅ 完了済み    |
| **Phase 4: ログと可視化**      | スコアや出典を記録・分析できるように            | 🔜 オプションで並行可能  |
| **Phase 5: CI対応**        | GitHub Actions等で自動テスト・品質管理    | 🕒 任意タイミングで実施可 |
| **Phase 6: UX連携／Agent化** | UI化 or Bot化による応答体験の設計         | 🧭 将来的ステージ     |


# Task List（次にやること）
## Phase 2
🗓️ 2025/05/31 \[Saturday] 11:20

### Task 1: `main.py` の役割を明確化する
* [☑️] 使用されていない場合は削除する
* [ ] 使用する場合は何のためか `README` に記述を追加する

### Task 2: `scripts/` ディレクトリのスクリプト分類
* [☑️] `manual_run.py`、`multi_run.py` の目的をコメントで明確にする
* [☑️] 本番用とテスト用の区分を `README` または `scripts/README.md` に明記する

### Task 3: `settings.py` の整理と意図の明文化
* [☑️] 今後 `.env` に持たせるもの・`settings.py` に残すものを分類する
* [☑️] 増えそうな項目があれば事前に構造を設計しておく
* [☑️] `README` に「どこで設定を変更するのか」を簡潔に記載

### Task 4: 自動テストの整備 (`test_qa_search.py`)
* [☑️] 現在のテストがどこまで網羅しているか確認する
* [☑️] 今後CIに組み込む場合に備え、`pytest`で動作するか確認しておく
    > 「pytestで7件自動テストパス済み」＝**自動QAの基盤が確立された状態**
---

## Phase 3
* [☑️] `target_pdf` 対応
* [☑️] スコアしきい値の導入

---

## 🗂 Phase 4: ログと可視化
- 目的：「あとから読みやすく分析しやすい」状態にすること

### Task 1: スコアと出典のログ構造設計

* [☑️] チャンクのスコア、出典（source, page）を含むログ形式を決める（JSONで出力想定）
* [☑️] 出力先のディレクトリ（例：`logs/qa_test_results.json`）を固定し、ルール化する
* [☑️] 出力対象：質問・PDF・スコア・チャンク数・回答文（あれば）

---

### Task 2: ログ出力機能の追加

* [☑️] `test_qa_search.py` に `--log-output` オプションでログ出力を切り替えられるようにする
* [☑️] ログモード時に、質問ごとの結果を整形して追記（append）形式で出力する
* [☑️] テスト実行後、ログファイルに質問とそのヒット文書・スコアが記録されることを確認

---

### Task 3: ログ出力の品質チェックと可視化の土台

* [☑️] ログファイルがJSONとして正しく構造化されているか確認する
* [☑️] ページ数やファイル名などの情報が出力されているかチェック
* [ ] 今後の分析やUI連携を想定して、最低限の構造整備をしておく（例：`query_id`, `timestamp` など）

---
